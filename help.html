<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0,shrink-to-fit=no">
	<!-- 兼容IOS9 -->
	<title>北理镜像站 | 帮助文档</title>
	<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

	<!-- <link rel="stylesheet" href="css/bootstrap.min.css"> -->
</head>
<body>
	<header>
		<div class="collapse bg-dark" id="headerNav">
			<div class="container">
				<div class="row">
					<div class="col-sm-8 col-md-7 py-4">
						<h4 class="text-white">About</h4>
						<p class="text-muted">
							北理镜像站是由北京理工大学网络开拓者协会负责运营的开源镜像站
						</p>
					</div>
					<div class="col-sm-4 offset-md-1 py-4">
						<h4 class="text-white">Contact</h4>
						<ul class="list-unstyled">
			                <li><a href="http://www.bit.edu.cn/" class="text-white">北京理工大学官网</a></li>
			                <li><a href="https://www.bitnp.net/" class="text-white">网络开拓者协会(BITNP)主页</a></li>
			                <li><a href="https://www.bitnp.net/" class="text-white">加入我们</a></li>
			                <li><a href="https://www.bitnp.net/" class="text-white">联系我们</a></li>
			            </ul>
					</div>
				</div>
			</div>
		</div>
		<div class="navbar navbar-dark bg-dark box-shadow">
			<div class="container d-flex justify-content-between">
				<a href="#" class="navbar-brand d-flex align-items-center"> 
					<strong>北理镜像站</strong>
				</a>
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#headerNav" aria-controls="navbarHeader" aria-expended="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
			</div>
		</div>
	</header>

	<main>
		<section class="jumbotron">
			<div class="container">
				<div class="row">
					<div class="col-md-4">
						<div class="input-group mb-3 mt-5">
							<input type="text" class="form-control" id="input-query" aria-describedby="basic-addon3">
							<div class="input-group-append">
								<button class="btn btn-outline-secondary" id="btn-search">搜索</button>
							</div>
						</div>
						<ul class="nav flex-column nav-pills" id="md-slideBar">
						</ul>
					</div>
					<div class="col-md-8">
						<div id="tabContent"></div>
					</div>
				</div>
			</div>
		</section>
		<div class="py-5 bg-light">
			<div class="container" id="main_container">

			</div>
		</div>
	</main>

	<footer class="text-muted">
		<div class="container">
			<p class="float-right">
				<a href="#">回到顶部</a>
			</p>
			<p>
				Copyright © 1997-2018 Net Pioneer Association of BIT All Rights Reserved. Designed by Maidong
			</p>
		</div>		
	</footer>
	<!-- <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
	<script src="https://cdn.bootcss.com/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
	<script src="https://cdn.bootcss.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script> -->
    <script src="js/jquery.slim.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="showdown.min.js"></script>
    <script src="js/functions.js"></script>
    <script src="js/socket.io.2.0.3.js"></script>
    <script>
		requests = GetRequest();
        var socket = io('http://localhost:3000');
        socket.emit('data', {
          "type": "mirrorsDir"
        });
        socket.on('data',
        function(data) {
          console.log(data);
          data = dataFilter(data);
          console.log(data);
          window.data = data;
          loadHTML(data.datas);
        });
        
        // 加载网页内容
        function loadHTML(data) {
        	var row = 0;
			var slideBar = document.getElementById("md-slideBar");
        	for (var mir = 0; mir < data.length; mir++) {
	            var path = data[mir].path;
	            var type = data[mir].type;
	            var li = null;
	            if(type == "directory") {
					li = document.createElement('li');
					li.className = 'nav-item';
					a = document.createElement('a');
					a.className = 'nav-link';
					a.href = '?mirror='+path;
					a.innerText = path;
					li.appendChild(a);
					slideBar.insertBefore(li, slideBar.firstChlid);
            	}
	        }
			var staticNodes = '<li class="nav-item"><a class="nav-link" href="../mirrors">进入下载页</a></li><li class="nav-item"><a class="nav-link" href="../">回到主页</a></li>';
			slideBar.innerHTML += staticNodes;
          // $('#mirrors tr').each(function() {
          //   $(this).on("click",
          //   function() {
          //     var href = window.location.pathname;
          //     href += '/' + $(this).find('td').eq(0).text();
          //     window.location.href = href;
          //   });
          // });
        }

        // 搜索按钮
        $('#btn-search').click(function() {UrlJump({"query": $("#input-query").val()});});

        // 回车执行搜索
        $("#input-query").keydown(function(e) {switch (e.keyCode) {case 13:UrlJump({"query":$("#input-query").val()});break;default:break}});

        window.onload = function() {

                var ajax;

                /*1.创建XMLHttpRequest对象*/
                if(window.XMLHttpRequest) {
                    //  IE7+, Firefox, Chrome, Opera, Safari 浏览器执行代码
                    ajax = new XMLHttpRequest();
                } else {
                    // IE6, IE5 浏览器执行代码
                    ajax = new ActiveXObject("Microsoft.XMLHTTP");
                }
                if(requests['mirror']) {
	                /*设置请求方式和地址  默认是异步*/
	                path = '_help/'+requests['mirror']+'.md';
	                ajax.open("GET", path);
	                /*发送请求*/
	                ajax.send();                	
                } else {
                	ajax.open("GET", "_help/default.md");
                	ajax.send();
                }

                /*注册回调函数*/
                ajax.onreadystatechange = function() {
                    if(ajax.readyState == 4 && ajax.status == 200) {
                        let Convertor = new showdown.Converter();
                        let res = ajax.responseText;
                        let html = Convertor.makeHtml(res);
                        document.getElementById("tabContent").innerHTML = html;
                        $("#HowToDownloadMirrors").hide();
                    }
                }
            
        }
    </script>
<style>
    blockquote {
        border-left:#eee solid 5px;
        padding-left:20px;
    }
    ul li {
        line-height: 20px;
        list-style: none;
    }

    code {
        color:#D34B62;
        background: #F6F6F6;
    }
 	#result {
 		text-align: left;
 	}
</style>
</body>
</html>